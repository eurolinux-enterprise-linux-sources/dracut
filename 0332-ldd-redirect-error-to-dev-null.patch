From ee2cd169bd1e169da0cbb43eea85f3e92c107030 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Mon, 14 Oct 2013 10:24:46 +0200
Subject: [PATCH] ldd: redirect error to /dev/null

---
 modules.d/01fips/install                      | 2 +-
 modules.d/40network/install                   | 2 +-
 modules.d/50plymouth/plymouth-populate-initrd | 2 +-
 modules.d/90dm/install                        | 2 +-
 modules.d/90dmraid/install                    | 2 +-
 modules.d/90lvm/install                       | 2 +-
 modules.d/95nfs/install                       | 2 +-
 modules.d/95udev-rules/install                | 2 +-
 8 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/modules.d/01fips/install b/modules.d/01fips/install
index ee5c38b..67ef284 100755
--- a/modules.d/01fips/install
+++ b/modules.d/01fips/install
@@ -6,7 +6,7 @@ inst "$moddir/fips.sh" /sbin/fips.sh
 dracut_install sha512hmac rmmod insmod mount uname umount
 
 libdir="lib"
-if ldd $(find_binary sha512hmac) |grep -q /lib64/; then
+if ldd $(find_binary sha512hmac) 2>/dev/null | grep -q /lib64/; then
     libdir="lib64"
 fi
 
diff --git a/modules.d/40network/install b/modules.d/40network/install
index a94c2a4..348ef0b 100755
--- a/modules.d/40network/install
+++ b/modules.d/40network/install
@@ -19,7 +19,7 @@ inst_hook cmdline 99 "$moddir/parse-ip-opts.sh"
 inst_hook cmdline 99 "$moddir/parse-ifname.sh"
 inst_hook pre-pivot 10 "$moddir/kill-dhclient.sh"
 
-if ldd $(which sh) | grep -q lib64; then
+if ldd $(which sh) 2>/dev/null | grep -q lib64; then
     LIBDIR="/lib64"
 else
     LIBDIR="/lib"
diff --git a/modules.d/50plymouth/plymouth-populate-initrd b/modules.d/50plymouth/plymouth-populate-initrd
index effb0f9..99c8f3e 100755
--- a/modules.d/50plymouth/plymouth-populate-initrd
+++ b/modules.d/50plymouth/plymouth-populate-initrd
@@ -1,5 +1,5 @@
 #!/bin/bash
-if ldd /sbin/plymouthd |grep -q lib64; then
+if ldd /sbin/plymouthd 2>/dev/null | grep -q lib64; then
     LIBDIR="/usr/lib64"
 else
     LIBDIR="/usr/lib"
diff --git a/modules.d/90dm/install b/modules.d/90dm/install
index a1948b6..96ddc75 100755
--- a/modules.d/90dm/install
+++ b/modules.d/90dm/install
@@ -7,7 +7,7 @@ inst dmsetup
 
 inst dmeventd
 
-if ldd $(which dmsetup) | grep -q lib64; then
+if ldd $(which dmsetup) 2>/dev/null | grep -q lib64; then
     LIBDIR="/lib64"
 else
     LIBDIR="/lib"
diff --git a/modules.d/90dmraid/install b/modules.d/90dmraid/install
index 17b4226..bc731ae 100755
--- a/modules.d/90dmraid/install
+++ b/modules.d/90dmraid/install
@@ -3,7 +3,7 @@ dracut_install dmraid partx kpartx
 
 inst  dmeventd
 
-if ldd $(which dmraid) | grep -q lib64; then
+if ldd $(which dmraid) 2>/dev/null | grep -q lib64; then
     LIBDIR="/lib64"
 else
     LIBDIR="/lib"
diff --git a/modules.d/90lvm/install b/modules.d/90lvm/install
index 2339770..5c7e758 100755
--- a/modules.d/90lvm/install
+++ b/modules.d/90lvm/install
@@ -18,7 +18,7 @@ inst "$moddir/lvm_scan.sh" /sbin/lvm_scan
 inst_hook cmdline 30 "$moddir/parse-lvm.sh"
 
 
-if ldd $(which lvm) | grep -q lib64; then
+if ldd $(which lvm) 2>/dev/null | grep -q lib64; then
     LIBDIR="/lib64"
 else
     LIBDIR="/lib"
diff --git a/modules.d/95nfs/install b/modules.d/95nfs/install
index 5432a22..cc2a678 100755
--- a/modules.d/95nfs/install
+++ b/modules.d/95nfs/install
@@ -9,7 +9,7 @@ dracut_install /etc/nsswitch.conf /etc/rpc /etc/protocols
 dracut_install rpc.idmapd /etc/idmapd.conf
 dracut_install sed
 
-if ldd $(which rpc.idmapd) |grep -q lib64; then
+if ldd $(which rpc.idmapd) 2>/dev/null | grep -q lib64; then
     LIBDIR="/lib64"
 else
     LIBDIR="/lib"
diff --git a/modules.d/95udev-rules/install b/modules.d/95udev-rules/install
index 1e648d5..fd3492b 100755
--- a/modules.d/95udev-rules/install
+++ b/modules.d/95udev-rules/install
@@ -47,7 +47,7 @@ pcmcia-check-broken-cis \
 done
 
 
-if ldd $(find_binary udevd) |grep -q /lib64/; then
+if ldd $(find_binary udevd) 2>/dev/null |grep -q /lib64/; then
     dracut_install /lib64/libnss_files*
 else
     dracut_install /lib/libnss_files*
