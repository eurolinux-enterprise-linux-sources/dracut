From cbc8b70f7a46d770bc24e52769ef9e19b1c2067a Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Thu, 8 Dec 2011 15:04:04 +0100
Subject: [PATCH] 95iscsi/iscsiroot: unset used variables before starting

If iscsiroot is called multiple times, then some variables can hold the
values of a previous call, so unset all variables before using them.

https://bugzilla.redhat.com/show_bug.cgi?id=752066
https://bugzilla.redhat.com/show_bug.cgi?id=752005
---
 modules.d/95iscsi/iscsiroot | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/modules.d/95iscsi/iscsiroot b/modules.d/95iscsi/iscsiroot
index 0bf6726..2b26f7f 100755
--- a/modules.d/95iscsi/iscsiroot
+++ b/modules.d/95iscsi/iscsiroot
@@ -49,6 +49,11 @@ if getarg iscsi_firmware ; then
     exit 0
 fi
 
+unset iscsi_initiator iscsi_target_name iscsi_target_ip iscsi_target_port
+unset iscsi_target_group iscsi_protocol iscsirw iscsi_lun
+unset iscsi_username iscsi_password 
+unset iscsi_in_username iscsi_in_password
+
 # override conf settings by command line options
 arg=$(getarg iscsi_initiator)
 [ -n "$arg" ] && iscsi_initiator=$arg
