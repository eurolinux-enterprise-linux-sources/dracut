From 0147a3be1758fe39ff5802298f2d26171adcf965 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Thu, 11 Oct 2012 13:14:13 +0200
Subject: [PATCH] fcoe/fcoe-up: sleep for 3s to allow dcb negotiation

https://bugzilla.redhat.com/show_bug.cgi?id=813057
---
 modules.d/95fcoe/fcoe-up | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/modules.d/95fcoe/fcoe-up b/modules.d/95fcoe/fcoe-up
index 89783d4..74f8693 100755
--- a/modules.d/95fcoe/fcoe-up
+++ b/modules.d/95fcoe/fcoe-up
@@ -40,6 +40,8 @@ elif [ "$netdriver" = "bnx2x" ]; then
     # If driver is bnx2x, do not use /sys/module/fcoe/parameters/create but fipvlan
     modprobe 8021q
     udevadm settle --timeout=30 >/dev/null 2>&1
+    # Sleep for 3 s to allow dcb negotiation
+    sleep 3
     fipvlan "$netif" -c -s
 else
     echo -n "$netif" > /sys/module/fcoe/parameters/create
