From a22c502d869cdfbe1cc15268255919cf10271a89 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Mon, 14 Oct 2013 17:59:18 +0200
Subject: [PATCH] fcoe: add --link-retry=100 to fipvlan call

Resolves: rhbz#1012316
---
 modules.d/95fcoe/fcoe-up | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/modules.d/95fcoe/fcoe-up b/modules.d/95fcoe/fcoe-up
index 43a366e..6b856fb 100755
--- a/modules.d/95fcoe/fcoe-up
+++ b/modules.d/95fcoe/fcoe-up
@@ -35,14 +35,14 @@ if [ "$dcb" = "dcb" ]; then
     sleep 1
     dcbtool sc "$netif" app:fcoe e:1 a:1 w:1
     sleep 1
-    fipvlan "$netif" -c -s -f "-fcoe"
+    fipvlan "$netif" -c -s --link-retry=100 -f "-fcoe"
 elif [ "$netdriver" = "bnx2x" ] || getarg 'autovlan=yes'; then
     # If driver is bnx2x, do not use /sys/module/fcoe/parameters/create but fipvlan
     modprobe 8021q
     udevadm settle --timeout=30 >/dev/null 2>&1
     # Sleep for 3 s to allow dcb negotiation
     sleep 3
-    fipvlan "$netif" -c -s -f "-fcoe"
+    fipvlan "$netif" -c -s --link-retry=100 -f "-fcoe"
 else
     echo -n "$netif" > /sys/module/fcoe/parameters/create
 fi
