From 5db3f2daca1bb2aef6d082aef7c9806f3e40e383 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Thu, 18 Feb 2010 08:46:57 +0100
Subject: [PATCH] selinux: fix "selinux=0" handling

---
 modules.d/99base/selinux-loadpolicy.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/modules.d/99base/selinux-loadpolicy.sh b/modules.d/99base/selinux-loadpolicy.sh
index f3bacec..93d6f2c 100755
--- a/modules.d/99base/selinux-loadpolicy.sh
+++ b/modules.d/99base/selinux-loadpolicy.sh
@@ -55,7 +55,7 @@ rd_load_policy()
 	    exit 1
 	fi
 	return 0
-    elif [ $permissive -eq 0 ]; then
+    elif [ $permissive -eq 0 -a $disabled -eq 0 ]; then
 	warn "Machine in enforcing mode and cannot execute load_policy."
 	warn "To disable selinux, add selinux=0 to the kernel command line."
 	warn "Not continuing"
