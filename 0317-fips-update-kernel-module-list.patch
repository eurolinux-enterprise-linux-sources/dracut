From 64eb9963230966a798bcc649dc3d8b186b4f00fd Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Thu, 25 Jul 2013 11:07:47 +0200
Subject: [PATCH] fips: update kernel module list

---
 modules.d/01fips/installkernel | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/modules.d/01fips/installkernel b/modules.d/01fips/installkernel
index dc75cd9..1676cf8 100755
--- a/modules.d/01fips/installkernel
+++ b/modules.d/01fips/installkernel
@@ -1,13 +1,14 @@
 #!/bin/bash
 
-FIPSMODULES="aead aes_generic xts gf128mul aes-x86_64 ansi_cprng cbc ccm chainiv ctr"
-FIPSMODULES="$FIPSMODULES des deflate ecb eseqiv hmac seqiv sha256 sha512"
-FIPSMODULES="$FIPSMODULES cryptomgr crypto_null tcrypt" 
-FIPSMODULES="$FIPSMODULES dm-mod dm-crypt" 
+_fipsmodules="aead aes_generic aes-x86_64 ansi_cprng arc4 blowfish camellia cast6 cbc ccm "
+_fipsmodules+="chainiv crc32c cryptomgr crypto_null ctr cts deflate des des3_ede dm-crypt dm-mod "
+_fipsmodules+="ecb eseqiv fcrypt gcm ghash_generic hmac khazad lzo md4 md5 michael_mic rmd128 "
+_fipsmodules+="rmd160 rmd256 rmd320 rot13 salsa20 seed seqiv serpent sha1 sha224 sha256 sha256_generic "
+_fipsmodules+="sha384 sha512 sha512_generic tcrypt tea tnepres twofish wp256 wp384 wp512 xeta xtea xts zlib"
 
 mkdir -p "${initdir}/etc/modprobe.d"
 
-for mod in $FIPSMODULES; do 
+for mod in $_fipsmodules; do
     if hostonly='' instmods $mod; then
         echo $mod >> "${initdir}/etc/fipsmodules"
         echo "blacklist $mod" >> "${initdir}/etc/modprobe.d/fips.conf"
