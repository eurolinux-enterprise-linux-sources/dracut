From c0f212dbbc0463efc0a24f6893fce3cd0c0fbcbf Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Fri, 5 Aug 2011 11:54:49 +0200
Subject: [PATCH] 90mdraid: move force assembly to timeout initqueue

---
 modules.d/90mdraid/65-md-incremental-imsm.rules | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/modules.d/90mdraid/65-md-incremental-imsm.rules b/modules.d/90mdraid/65-md-incremental-imsm.rules
index 57db798..b77c1bf 100644
--- a/modules.d/90mdraid/65-md-incremental-imsm.rules
+++ b/modules.d/90mdraid/65-md-incremental-imsm.rules
@@ -28,7 +28,7 @@ LABEL="do_md_inc"
 # 
 ENV{rd_MDADMCONF}!="?*", GOTO="md_auto_end"
 
-RUN+="/bin/sh -c 'ln -s /sbin/md_finished.sh /initqueue-finished/md_finished.sh;/sbin/initqueue --settled --onetime --unique /sbin/mdadm_auto'"
+RUN+="/bin/sh -c 'ln -s /sbin/md_finished.sh /initqueue-finished/md_finished.sh;/sbin/initqueue --timeout --onetime --unique /sbin/mdadm_auto'"
 
 GOTO="md_inc_end"
 
@@ -61,7 +61,7 @@ LABEL="do_raidstart"
 # check if array is not inactive anymore
 TEST=="md/array_state", ATTR{md/array_state}!="|inactive", GOTO="end_raidstart"
 
-RUN+="/bin/sh -c 'ln -s /sbin/md_finished.sh /initqueue-finished/md_finished.sh;/sbin/initqueue --settled --onetime --unique /sbin/mdraid_start'"
+RUN+="/bin/sh -c 'ln -s /sbin/md_finished.sh /initqueue-finished/md_finished.sh;/sbin/initqueue --timeout --onetime --unique /sbin/mdraid_start'"
 
 LABEL="end_raidstart"
 
@@ -80,6 +80,6 @@ GOTO="end_container"
 
 LABEL="do_container"
 
-RUN+="/bin/sh -c 'ln -s /sbin/md_finished.sh /initqueue-finished/md_finished.sh;/sbin/initqueue --settled --onetime --unique --name mdcontainer_start-%k /sbin/mdcontainer_start $env{DEVNAME}'"
+RUN+="/bin/sh -c 'ln -s /sbin/md_finished.sh /initqueue-finished/md_finished.sh;/sbin/initqueue --timeout --onetime --unique --name mdcontainer_start-%k /sbin/mdcontainer_start $env{DEVNAME}'"
 
 LABEL="end_container"
