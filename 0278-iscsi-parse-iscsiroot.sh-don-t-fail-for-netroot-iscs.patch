From c76de095b2e590b11361040f3007b3a3b1728fac Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Wed, 28 Mar 2012 17:25:02 +0200
Subject: [PATCH] iscsi/parse-iscsiroot.sh: don't fail for "netroot=iscsi
 iscsi_firmware"

---
 modules.d/95iscsi/parse-iscsiroot.sh | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/modules.d/95iscsi/parse-iscsiroot.sh b/modules.d/95iscsi/parse-iscsiroot.sh
index 5b5ac92..18e2373 100755
--- a/modules.d/95iscsi/parse-iscsiroot.sh
+++ b/modules.d/95iscsi/parse-iscsiroot.sh
@@ -69,7 +69,9 @@ fi
 # If it's not iscsi we don't continue
 [ "${netroot%%:*}" = "iscsi" ] || return
 
-parse_iscsi_root "$netroot" || return
+if [ -z "$iscsi_firmware" ] ; then
+    parse_iscsi_root "$netroot" || return
+fi
 
 # ISCSI actually supported?
 if ! [ -e /sys/module/iscsi_tcp ]; then
