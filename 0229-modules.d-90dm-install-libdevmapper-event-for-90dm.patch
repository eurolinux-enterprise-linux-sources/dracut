From 9ee1b78fcb7d2b586d7cacdc9892b4618ee51f7b Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Fri, 5 Aug 2011 13:23:51 +0200
Subject: [PATCH] modules.d/90dm: install libdevmapper-event* for 90dm

---
 modules.d/90dm/install     | 11 +++++++++++
 modules.d/90dmraid/install | 15 ++-------------
 2 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/modules.d/90dm/install b/modules.d/90dm/install
index f77d945..e893915 100755
--- a/modules.d/90dm/install
+++ b/modules.d/90dm/install
@@ -6,4 +6,15 @@ modinfo -k $kernel dm_mod >/dev/null 2>&1 && \
 inst dmsetup
 
 inst dmeventd
+
+if ldd $(which dmraid) | grep -q lib64; then
+    LIBDIR="/lib64"
+else
+    LIBDIR="/lib"
+fi
+
+for i in $(ls /{usr,}/$LIBDIR/libdmraid-events*.so 2>/dev/null); do
+    dracut_install $i
+done
+
 inst_rules 10-dm.rules 95-dm-notify.rules
diff --git a/modules.d/90dmraid/install b/modules.d/90dmraid/install
index a016e4d..679d9cf 100755
--- a/modules.d/90dmraid/install
+++ b/modules.d/90dmraid/install
@@ -1,20 +1,9 @@
 #!/bin/bash
-dracut_install dmraid partx kpartx 
+dracut_install dmraid partx kpartx
 
 inst  dmeventd
 
-if ldd $(which dmraid) | grep -q lib64; then
-    LIBDIR="/lib64"
-else
-    LIBDIR="/lib"
-fi
-
-for i in $(ls /{usr,}/$LIBDIR/libdmraid-events*.so 2>/dev/null); do
-    dracut_install $i
-done
-
-
-inst_rules 10-dm.rules 13-dm-disk.rules 95-dm-notify.rules 
+inst_rules 13-dm-disk.rules
 
 inst "$moddir/dmraid.sh" /sbin/dmraid_scan
 
