From 97ff4a0003fb218640b04ba6314c66db236b88d0 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Tue, 3 Mar 2015 10:32:39 +0100
Subject: [PATCH] fips: nss-softokn-freebl has its own dracut module now

https://bugzilla.redhat.com/show_bug.cgi?id=1182297
---
 dracut.spec              | 2 +-
 modules.d/01fips/install | 6 ++----
 2 files changed, 3 insertions(+), 5 deletions(-)

diff --git a/dracut.spec b/dracut.spec
index 47ed965..5f2b748 100644
--- a/dracut.spec
+++ b/dracut.spec
@@ -91,7 +91,7 @@ Requires: nss
 %else
 Requires: nss-softokn
 %endif
-Requires: nss-softokn-freebl
+Requires: nss-softokn-freebl >= 3.14.3-22.el6_6
 
 %description fips
 This package requires everything which is needed to build an
diff --git a/modules.d/01fips/install b/modules.d/01fips/install
index 95c41e1..c3c3bf5 100755
--- a/modules.d/01fips/install
+++ b/modules.d/01fips/install
@@ -12,12 +12,10 @@ fi
 
 if [ -e /usr/$libdir/libsoftokn3.so ]; then
     dracut_install \
-        /usr/$libdir/libsoftokn3.so /usr/$libdir/libsoftokn3.chk \
-        /usr/$libdir/libfreebl3.so /usr/$libdir/libfreebl3.chk 
+        /usr/$libdir/libsoftokn3.so /usr/$libdir/libsoftokn3.chk
 else
     dracut_install \
-        /$libdir/libsoftokn3.so /$libdir/libsoftokn3.chk \
-        /$libdir/libfreebl3.so /$libdir/libfreebl3.chk 
+        /$libdir/libsoftokn3.so /$libdir/libsoftokn3.chk
 fi
 
 for i in /{usr,}/$libdir/libssl.so* /{usr,}/$libdir/libcrypto.so* \
