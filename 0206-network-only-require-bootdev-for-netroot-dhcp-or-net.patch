From 6b3248074bb74a084d9a72788f9142dd83c5a3cf Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Tue, 19 Apr 2011 13:09:41 +0200
Subject: [PATCH] network: only require bootdev for netroot=dhcp or
 netroot=dhcp6

---
 modules.d/40network/parse-ip-opts.sh | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/modules.d/40network/parse-ip-opts.sh b/modules.d/40network/parse-ip-opts.sh
index 8ec94bf..579e67b 100755
--- a/modules.d/40network/parse-ip-opts.sh
+++ b/modules.d/40network/parse-ip-opts.sh
@@ -35,12 +35,14 @@ if [ -n "$netroot" ] && [ -z "$(getarg ip=)" ] ; then
 fi
 
 # Count ip= lines to decide whether we need bootdev= or not
-if [ -z "$NEEDBOOTDEV" ] ; then
-    local count=0
-    for p in $(getargs ip=); do
-	count=$(( $count + 1 ))
-    done
-    [ $count -gt 1 ] && NEEDBOOTDEV=1
+if [ "$netroot" = "dhcp" ] || [ "$netroot" = "dhcp6" ]; then
+    if [ -z "$NEEDBOOTDEV" ] ; then
+	local count=0
+	for p in $(getargs ip=); do
+	    count=$(( $count + 1 ))
+	done
+	[ $count -gt 1 ] && NEEDBOOTDEV=1
+    fi
 fi
 
 # If needed, check if bootdev= contains anything usable
