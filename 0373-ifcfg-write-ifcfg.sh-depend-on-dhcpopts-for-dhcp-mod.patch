From 25c7c10c58780d599179ea82e7b98bb2f21a6be2 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Tue, 17 Mar 2015 11:58:20 +0100
Subject: [PATCH] ifcfg/write-ifcfg.sh: depend on dhcpopts for dhcp mode

---
 modules.d/45ifcfg/write-ifcfg.sh | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/modules.d/45ifcfg/write-ifcfg.sh b/modules.d/45ifcfg/write-ifcfg.sh
index 16d4793..30a934d 100644
--- a/modules.d/45ifcfg/write-ifcfg.sh
+++ b/modules.d/45ifcfg/write-ifcfg.sh
@@ -38,21 +38,21 @@ for netif in $IFACES ; do
     if [ "$netif" = "$vlanname" ]; then
         vlan=yes
     fi
-    cat /sys/class/net/$netif/address > /tmp/net.$netif.hwaddr
+    cat /sys/class/net/$netif/address > /tmp/net.${netif}.hwaddr
     {
         echo "# Generated by dracut initrd"
         echo "DEVICE=$netif"
         echo "ONBOOT=yes"
         echo "NETBOOT=yes"
-        if [ -f /tmp/dhclient.$netif.lease ]; then
+        if [ -f /tmp/dhclient.${netif}.dhcpopts ]; then
             strstr "$ip" '*:*:*' && echo "DHCPV6C=yes"
             echo "BOOTPROTO=dhcp"
-	    [ -f /tmp/dhclient.$netif.lease ] &&    cp /tmp/dhclient.$netif.lease    /tmp/net.$netif.lease
-	    [ -f /tmp/dhclient.$netif.dhcpopts ] && cp /tmp/dhclient.$netif.dhcpopts /tmp/net.$netif.dhcpopts
+	    [ -f /tmp/dhclient.${netif}.lease ] &&    cp /tmp/dhclient.${netif}.lease    /tmp/net.${netif}.lease
+	    [ -f /tmp/dhclient.${netif}.dhcpopts ] && cp /tmp/dhclient.${netif}.dhcpopts /tmp/net.${netif}.dhcpopts
         else
             echo "BOOTPROTO=none"
             # If we've booted with static ip= lines, the override file is there
-            [ -e /tmp/net.$netif.override ] && . /tmp/net.$netif.override
+            [ -e /tmp/net.${netif}.override ] && . /tmp/net.${netif}.override
             echo "IPADDR=$ip"
             echo "NETMASK=$mask"
             [ -n "$gw" ] && echo "GATEWAY=$gw"
